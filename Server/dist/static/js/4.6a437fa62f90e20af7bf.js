webpackJsonp([4],{NQCH:function(e,t,s){e.exports=s.p+"static/img/qunzu.4fe7a2e.jpg"},eM6X:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={data:function(){return{groupinfo:{group_name:""},isleader:!1,isadmin:!1,newGroupVisible:!1,groupTaskVisible:!1,groupMenberVisible:!1,group_id:"",user:{user_id:"",user_name:""},search:"",usergroup:[],grouptask:[],menberlist:[],leaderlist:[],adminlist:[]}},methods:{init:function(){this.getgroup(),this.searchleader(),this.searchadmin()},addmenber:function(){var e=this;this.$prompt("请输入用户名","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(t){var s=t.value;e.$http.post(e.url+"/message/invmessage",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id,group_id:e.group_id,time:e.dateToString(new Date),type:1,toname:s}).then(function(t){1===t.index?e.$message({type:"success",message:"邀请成功"}):2===t.index?e.$message({type:"info",message:"请勿重复发送请求"}):0===t.index?e.$message({type:"info",message:"该用户已在群组中"}):3===t.index&&e.$message({type:"warning",message:"该用户不存在"})})}).catch(function(){e.$message({type:"info",message:"取消输入"})})},getgroup:function(){var e=this;this.$http.post(this.url+"/group/getall",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id}).then(function(t){console.log(t);for(var s=[],n=[],o=Math.floor(t.data.length/4),r=0;r<=o;r++){for(var i=4*r,a=0;a<4;a++)t.data[a+i]&&s.push(t.data[a+i]);n.push(s),s=[]}console.log(n),e.usergroup=n;for(var u=0;u<e.usergroup.length;u++)for(var l=0;l<e.usergroup[u].length;l++)e.usergroup[u][l].group_leaderId===JSON.parse(sessionStorage.getItem("EX_token")).user_id?e.$set(e.usergroup[u][l],"isleader",!0):e.$set(e.usergroup[u][l],"isleader",!1)})},watchgrouptask:function(e){for(var t=this,s=0;s<this.leaderlist.length;s++)e===this.leaderlist[s]&&(this.isleader=!0);var n=this;this.groupTaskVisible=!0,this.$http.post(this.url+"/group/getgrouptask",{group_id:e}).then(function(e){if(console.log(e),0!==e.data)for(var s=0;s<e.data.split(",").length;s++)t.$http.post(t.url+"/task/findByid",{task_id:e.data.split(",")[s]}).then(function(e){console.log(e),n.grouptask.push(e.data[0])});else t.$message({message:"没有群组任务哦",type:"warning"})}).catch(function(){})},watchgoupmenber:function(e){this.group_id=e;for(var t=0;t<this.leaderlist.length;t++)e===this.leaderlist[t]&&(this.isleader=!0);var s=this;this.groupMenberVisible=!0,this.$http.post(this.url+"/group/getgroupmenber",{group_id:e}).then(function(e){for(var t=e.data.split(","),n=0;n<t.length;n++)s.menberlist.push({name:t[n]})})},newGroup:function(){this.newGroupVisible=!0},searchleader:function(){var e=this;this.$http.post(this.url+"/group/searchleader",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id}).then(function(t){console.log(t);for(var s=0;s<t.data.length;s++)e.leaderlist.push(t.data[s].group_id)}).catch(function(){})},levelup:function(e){var t=this;console.log(e),this.$confirm("是否让"+e.name+"获得管理员权限","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(t.url+"/group/beadmin",{user_name:e.name,group_id:t.group_id}).then(function(e){t.$message({message:e.message,type:"success"})}).catch(function(){}),t.groupMenberVisible=!1}).catch(function(){})},goout:function(e){var t=this;console.log(e),this.$confirm("是否将"+e.name+"踢出该团队","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(t.url+"/group/goout",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id,fuser_name:JSON.parse(sessionStorage.getItem("EX_token")).user_name,group_id:t.group_id,user_name:e.name,time:t.dateToString(new Date)}).then(function(e){t.$message({message:e.message,type:"success"}),t.init(),t.groupMenberVisible=!1}).catch(function(){})})},delegroup:function(e){var t=this;this.$confirm("是否解散该团队","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(t.url+"/group/delegroup",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id,group_id:e.group_id,time:t.dateToString(new Date)}).then(function(e){console.log(e),t.$message({message:"已解散该团队",type:"success"}),t.init()})})},quitgroup:function(e){var t=this;this.$confirm("是否退出该团队","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post(t.url+"/group/quitgroup",{group_id:e.group_id,user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id,user_name:JSON.parse(sessionStorage.getItem("EX_token")).user_name,time:t.dateToString(new Date)}).then(function(e){console.log(e),t.$message({message:"已退出该团队",type:"success"}),t.init()})})},searchadmin:function(){var e=this;this.$http.post(this.url+"/group/searchadmin",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id}).then(function(t){console.log(t);for(var s=0;s<t.data.length;s++)e.adminlist.push(t.data[s].group_id)}).catch(function(){})},searchGroup:function(){},closetask:function(){this.grouptask=[],this.isleader=!1},closemenber:function(){this.menberlist=[],this.isleader=!1},closenew:function(){this.newGroupVisible=!1,this.groupinfo={group_name:""}},noAdd:function(){var e=this;this.$confirm("是否取消新增？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.newGroupVisible=!1}).catch(function(){})},sureAdd:function(){var e=this;this.$confirm("是否新增？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){""===e.groupinfo.group_name?e.$message({type:"warning",message:"请输入群名"}):e.$http.post(e.url+"/group/newgroup",{user_id:JSON.parse(sessionStorage.getItem("EX_token")).user_id,user_name:JSON.parse(sessionStorage.getItem("EX_token")).user_name,group_name:e.groupinfo.group_name,time:e.dateToString(new Date)}).then(function(t){console.log(t),e.$message({type:"warning",message:t.message}),e.newGroupVisible=!1,e.init()}).catch(function(){})}).catch(function(){})},dateToString:function(e){var t=e.getFullYear(),s=e.getMonth()+1,n=e.getDate();return s<10&&(s="0"+s),n<10&&(n="0"+n),t+"-"+s+"-"+n}},created:function(){this.init()}},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"groupBody"},[n("div",{staticClass:"searchBar"},[n("el-button",{staticClass:"searchButton",attrs:{type:"primary",round:""},on:{click:e.newGroup}},[e._v("新增群组")])],1),e._v(" "),n("div",{staticClass:"groupItems"},e._l(e.usergroup,function(t,o){return n("el-row",{key:o,staticClass:"group-list",attrs:{gutter:20}},e._l(t,function(t,o){return n("el-col",{key:o,staticClass:"group-img",attrs:{span:5}},[n("el-card",{attrs:{"body-style":{padding:"0px"}}},[n("img",{staticClass:"image",attrs:{src:s("NQCH")}}),e._v(" "),n("div",{staticStyle:{padding:"14px"}},[n("span",[e._v(e._s(t.group_name))]),e._v(" "),n("span",[e._v("群主:"+e._s(t.group_leaderName))]),e._v(" "),n("div",{staticClass:"bottom clearfix"},[n("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(s){return e.watchgrouptask(t.group_id)}}},[e._v("查看团队任务")]),e._v(" "),n("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(s){return e.watchgoupmenber(t.group_id)}}},[e._v("查看团队成员")]),e._v(" "),t.isleader?[n("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(s){return e.delegroup(t)}}},[e._v("解散团队")])]:[n("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(s){return e.quitgroup(t)}}},[e._v("退出团队")])]],2)])])],1)}),1)}),1),e._v(" "),n("el-dialog",{attrs:{title:"群组任务",visible:e.groupTaskVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.groupTaskVisible=t},close:function(t){return e.closetask()}}},[n("el-table",{attrs:{data:e.grouptask}},[n("el-table-column",{attrs:{property:"task_name",label:"任务名称"}}),e._v(" "),n("el-table-column",{attrs:{property:"task_detail",label:"任务描述"}})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"群员列表",visible:e.groupMenberVisible,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.groupMenberVisible=t},close:function(t){return e.closemenber()}}},[e.isleader?[n("el-button",{attrs:{type:"primary",round:""},on:{click:e.addmenber}},[e._v("新增成员")]),e._v(" "),e._l(e.menberlist,function(t,s){return n("el-popover",{key:s,staticClass:"group-menberlist",attrs:{placement:"top",width:"160"}},[n("p",[e._v("更改群员状态")]),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(s){return e.goout(t)}}},[e._v("踢出群")])],1),e._v(" "),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.name))])],1)})]:e._l(e.menberlist,function(t,s){return n("el-popover",{key:s,staticClass:"group-menberlist",attrs:{placement:"top",width:"160"}},[n("p",[e._v("群成员")]),e._v(" "),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.name))])],1)})],2),e._v(" "),n("el-dialog",{attrs:{title:"新增群组",visible:e.newGroupVisible,width:"30%","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.newGroupVisible=t},close:function(t){return e.closenew()}}},[n("el-form",{ref:"groupinfo",staticClass:"demo-ruleForm",attrs:{model:e.groupinfo,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"群组名称",prop:"name"}},[n("el-input",{model:{value:e.groupinfo.group_name,callback:function(t){e.$set(e.groupinfo,"group_name",t)},expression:"groupinfo.group_name"}})],1)],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){return e.noAdd()}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.sureAdd()}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=s("VU/8")(n,o,!1,function(e){s("qGSG")},null,null);t.default=r.exports},qGSG:function(e,t){}});
//# sourceMappingURL=4.6a437fa62f90e20af7bf.js.map